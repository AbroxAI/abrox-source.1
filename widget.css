/* widget.css â€” Telegram 2026 replica with fixed mask tail and full grouping */

/* variables */
:root{
  --tg-bg-main:#0e1621;
  --tg-text:#e6eef8;
  --tg-muted:#9aa7bd;
  --tg-accent:#2ea6ff;
  --tg-avatar-size:40px;
  --tg-header-height:58px;
  --tg-input-height:46px;
  --tg-input-radius:24px;
  --gold:#ffd166;

  --tg-gap: calc(var(--tg-avatar-size) * 0.6);
}

/* base */
*{ box-sizing:border-box; }
html,body{
  height:100dvh;
  margin:0;
  color:var(--tg-text);
  background:linear-gradient(180deg,#0e1621,#17212b);
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  -webkit-font-smoothing:antialiased;
}
.hidden{display:none!important}

/* layout */
#tg-comments-app{ display:flex; flex-direction:column; height:100dvh; overflow:hidden; }

/* header */
.tg-header{
  display:flex; align-items:center; justify-content:space-between;
  height:var(--tg-header-height); padding:0 14px;
  background:rgba(23,33,43,0.78); backdrop-filter:blur(16px);
  position:sticky; top:0; z-index:60;
}
.tg-header-center{ display:flex; align-items:center; gap:10px; flex:1; margin:0 12px; min-width:0; }
.tg-header-avatar{ width:var(--tg-avatar-size); height:var(--tg-avatar-size); border-radius:50%; object-fit:cover; }
.tg-title{ font-size:15px; font-weight:700; }
.tg-meta{ font-size:12px; color:var(--tg-muted); margin-top:2px; }

/* comments container */
.tg-comments-container{
  flex:1 1 auto; padding:12px; overflow-y:auto; -webkit-overflow-scrolling:touch;
}
.tg-date-sticker{
  display:block; width:max-content; margin:12px auto; background:rgba(255,255,255,0.04);
  padding:6px 12px; border-radius:16px; font-size:12px; color:var(--tg-muted);
}

/* bubble wrapper */
.tg-bubble{
  display:flex; align-items:center; gap:var(--tg-gap); margin-bottom:14px; position:relative;
}
.tg-bubble.incoming{ justify-content:flex-start; }
.tg-bubble.outgoing{ flex-direction:row-reverse; margin-left:auto; }

.tg-bubble-avatar{
  width:var(--tg-avatar-size);
  height:var(--tg-avatar-size);
  border-radius:50%;
  object-fit:cover;
  flex-shrink:0;
}

/* bubble content */
.tg-bubble-content{
  padding:10px 14px; border-radius:18px; font-size:14px; line-height:1.35;
  word-break:break-word; position:relative; max-width:100%;
  box-shadow:0 4px 12px rgba(0,0,0,0.18);
  background:#182533; color:var(--tg-text);
}

/* incoming/outgoing colors */
.tg-bubble.incoming .tg-bubble-content{ background:#182533; color:#e6eef8; }
.tg-bubble.outgoing .tg-bubble-content{ background:#2b6df6; color:#fff; }

/* mask-based tail (correct Telegram style) */
.tg-bubble-content::after{
  content:""; position:absolute; width:16px; height:18px; bottom:2px;
  background:currentColor; pointer-events:none;
  -webkit-mask-size:contain; -webkit-mask-repeat:no-repeat;
  mask-size:contain; mask-repeat:no-repeat;
}
.tg-bubble.incoming .tg-bubble-content::after{
  left:-7px;
  -webkit-mask-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 20'><path d='M22 0 C14 6 8 12 0 14 C10 14 18 16 22 20 Z' fill='black'/></svg>");
  mask-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 20'><path d='M22 0 C14 6 8 12 0 14 C10 14 18 16 22 20 Z' fill='black'/></svg>");
}
.tg-bubble.outgoing .tg-bubble-content::after{
  right:-7px; transform:scaleX(-1);
  -webkit-mask-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 20'><path d='M22 0 C14 6 8 12 0 14 C10 14 18 16 22 20 Z' fill='black'/></svg>");
  mask-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 20'><path d='M22 0 C14 6 8 12 0 14 C10 14 18 16 22 20 Z' fill='black'/></svg>");
}

/* reply preview */
.tg-reply-preview{
  background:rgba(255,255,255,0.04); padding:6px 8px; border-left:3px solid rgba(255,255,255,0.08);
  border-radius:8px; margin-bottom:8px; font-size:12px; color:var(--tg-muted);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; cursor:pointer;
}

/* bubble text/meta */
.tg-bubble-text{ margin-top:4px; }
.tg-bubble-meta{ display:flex; align-items:center; gap:8px; margin-top:8px; font-size:11px; color:rgba(255,255,255,0.6); }

/* ---------- Telegram grouping ---------- */
.tg-bubble.tg-grouped-first .tg-bubble-content{ border-top-left-radius:18px; border-top-right-radius:18px; }
.tg-bubble.tg-grouped-middle .tg-bubble-content{ border-radius:12px; margin-top:-6px; }
.tg-bubble.tg-grouped-last .tg-bubble-content{
  border-bottom-left-radius:18px;
  border-bottom-right-radius:18px;
  margin-top:-6px;
}

/* hide tail for grouped */
.tg-bubble.tg-grouped-middle .tg-bubble-content::after,
.tg-bubble.tg-grouped-last .tg-bubble-content::after{ display:none; }

/* hide avatar for grouped except first */
.tg-bubble.tg-grouped-middle .tg-bubble-avatar,
.tg-bubble.tg-grouped-last .tg-bubble-avatar{ visibility:hidden; }

/* input */
.tg-input-wrapper{ padding:8px 12px; position:sticky; bottom:8px; display:flex; justify-content:center; }
.tg-input-bar{ display:flex; align-items:center; gap:8px; width:100%; max-width:640px; height:var(--tg-input-height); border-radius:var(--tg-input-radius); background:rgba(23,33,43,0.55); backdrop-filter:blur(14px); padding:0 12px; }
.tg-comment-input{ flex:1; height:100%; border:none; background:transparent; color:var(--tg-text); font-size:14px; outline:none; }
.tg-send-btn{ width:36px; height:36px; border-radius:50%; background:var(--tg-accent); color:#fff; border:none; display:flex; align-items:center; justify-content:center; cursor:pointer; }

/* responsive */
@media (max-width:520px){
  .tg-bubble{ max-width:86%; }
}
